import{_ as B,l as C,m as D,H as z,a as w,o as x,c as _,b as u,F as A,j as E,n as O,B as b,t as X,u as s,q as v,d as f,e as m,z as F,y as i,f as V}from"./index-a6d16cd4.js";import{f as Y}from"./index-93fa085a.js";import{c as J}from"./index-904b0323.js";const L=[{icon:"icon-24gf-folderOpen",name:"新建文件夹",color:"#FFD153",command:"folder"},{icon:"icon-Word",name:"新建在线文档",color:"#2A8CFF",command:"word"},{icon:"icon-excel",name:"新建在线表格",color:"#00C476",command:"excel"},{icon:"icon-wenben1",name:"新建在线文本",color:"",command:"txt"},{icon:"icon-file-markdown1",name:"新建markdown",color:"#1296db",command:"markdown"},{name:"导入本地文件",command:"inputfile"},{name:"更多类型",command:"more"},{name:"批量管理",command:"manage"}],P=g=>Y({url:"/folder/createFolder",method:"post",data:g});const R=["onClick"],U=["onClick"],W={class:"dialog-footer"},$={__name:"index",emits:["create","close"],setup(g,{expose:M,emit:d}){let e=C({show:!1,title:"",input:"",warning:"",placeholder:""});const l=C({x:0,y:0,display:"none"});function S(t){switch(t){case"folder":e.type=t,e.show=!0,e.title="创建文件夹",e.warning="请输入文件夹名称",e.placeholder="请输入文件夹名称";break;case"word":e.type=t,e.show=!0,e.title="新建 Word",e.warning="文件名称不能为空",e.placeholder="请输入文件名称";break;case"excel":e.type=t,e.show=!0,e.title="新建 Excel",e.warning="文件名称不能为空",e.placeholder="请输入文件名称";break;case"txt":e.type=t,e.show=!0,e.title="新建文本文档",e.warning="文件名称不能为空",e.placeholder="请输入文件名称";break;case"markdown":e.type=t,e.show=!0,e.title="新建markdown文档",e.warning="文件名称不能为空",e.placeholder="请输入文件名称";break}}function I(t,o){if(o){l.x=t.pageX-t.offsetX,l.y=t.pageY-t.offsetY,l.display="block";return}let a=t.pageX,n=t.pageY;l.x=a,l.y=n,l.display="block"}function h(){l.display="none",d("close")}async function N(t,o){let{folderid:a}=V.currentRoute.value.query,n=await P({userid:t,foldername:o,parentfolderid:a});return n.code!==200?i.error(n.msg):(i.success(n.msg),n.data)}async function q(){if(!e.input)return i.warning(e.warning);let{userid:t}=JSON.parse(sessionStorage.getItem("user")),o={type:e.type};if(e.type==="folder"){let a=e.input,n=await N(t,a);o.id=n,o.name=a}else{let{userid:a}=JSON.parse(sessionStorage.getItem("user")),n=e.input,y=e.type,c={txt:"txt",markdown:"md",word:"docx",excel:"xlsx"}[e.type],k=V.currentRoute.value.query.folderid,p=await J({userid:a,filename:n,filetype:y,filesuffix:c,fileownerfolderid:k});if(p.code!==200)return i.error(p.msg);i.success(p.msg),o.id=p.data,o.name=n,o.suffix=c}e.show=!1,e.input="",d("create",o),d("close")}return D(()=>{let t=z();const o=document.querySelector("body");o.append?o.append(t.vnode.el):o.appendChild(t.vnode.el)}),M({showContentMenu:I,hiddenContentMenu:h}),(t,o)=>{const a=w("el-input"),n=w("el-button"),y=w("el-dialog");return x(),_("div",{class:"box",onClick:v(h,["stop","self"])},[u("div",{onContextmenu:o[0]||(o[0]=v(()=>{},["stop"])),class:"contentmenu",style:b({left:l.x+"px",top:l.y+"px",display:l.display})},[(x(!0),_(A,null,E(s(L),(r,c)=>(x(),_("div",{key:c,onClick:k=>S(r.command)},[u("i",{class:O(["iconfont",r.icon]),style:b({color:r.color})},null,6),u("span",null,X(r.name),1)],8,U))),128))],36),f(y,{modelValue:s(e).show,"onUpdate:modelValue":o[3]||(o[3]=r=>s(e).show=r),title:s(e).title,width:"30%"},{footer:m(()=>[u("span",W,[f(n,{onClick:o[2]||(o[2]=r=>(s(e).show=!1,d("close"),s(e).input=""))},{default:m(()=>[F(" 取消 ")]),_:1}),f(n,{type:"primary",onClick:q},{default:m(()=>[F(" 确定 ")]),_:1})])]),default:m(()=>[f(a,{modelValue:s(e).input,"onUpdate:modelValue":o[1]||(o[1]=r=>s(e).input=r),placeholder:s(e).placeholder},null,8,["modelValue","placeholder"])]),_:1},8,["modelValue","title"])],8,R)}}},G=B($,[["__scopeId","data-v-f15a84d3"]]);export{G as C};
