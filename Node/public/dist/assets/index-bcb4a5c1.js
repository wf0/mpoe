import{_ as S,j as V,r as b,k as L,a as i,o as q,g as O,w as o,d as e,u as f,O as T,P as F,v as g,b as d,E as w,e as x,c as E,n as U,p as A,f as H}from"./index-264bb53a.js";import{f as $}from"./index-a16080e8.js";const N=c=>$({url:"/user/login",method:"post",data:c}),B=c=>$({url:"/user/register",method:"post",data:c});const M={class:"registerTip"},j={__name:"loginForm",emits:["toRegister"],setup(c,{emit:_}){const t=V({userid:"",password:"",checkpass:""}),p=b(null),v=V({userid:[{required:!0,message:"请输入账号！",trigger:"blur"}],password:[{required:!0,message:"请输入密码！",trigger:"blur"}],checkpass:[{required:!0,message:"请输入密码",trigger:"blur"},{validator:(r,s,l)=>{s!==t.password?l(new Error("密码不一致！")):l()},trigger:"blur"}]}),h=async r=>{r&&await r.validate((s,l)=>{if(s)return m();for(const n in l)if(Object.hasOwnProperty.call(l,n)){w.error(l[n][0].message);return}})},m=async()=>{let r=await N({userid:t.userid,password:t.password});if(r.code!==200)return w.error(r.msg);w.success(r.msg);let s=JSON.parse(JSON.stringify(r.data)),{token:l}=s;if(delete s.token,sessionStorage.setItem("token",l),sessionStorage.setItem("user",JSON.stringify(s)),x.currentRoute.value.query.fileid){let{fileid:n,filename:u,username:y}=x.currentRoute.value.query;return x.push({path:`/invited/${n}`,query:{filename:u,username:y}})}x.push("/home")},k=r=>(_("toRegister"),r.resetFields());return L(()=>{sessionStorage.clear()}),(r,s)=>{const l=i("el-icon"),n=i("el-input"),u=i("el-form-item"),y=i("el-button"),P=i("el-link"),R=i("el-form");return q(),O(R,{ref_key:"loginFormRef",ref:p,rules:v,model:t,"label-width":"0px"},{default:o(()=>[e(u,{prop:"userid"},{default:o(()=>[e(n,{placeholder:"请输入账号",modelValue:t.userid,"onUpdate:modelValue":s[0]||(s[0]=a=>t.userid=a)},{prefix:o(()=>[e(l,null,{default:o(()=>[e(f(T))]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(u,{prop:"password"},{default:o(()=>[e(n,{placeholder:"请输入密码",type:"password","show-password":"",modelValue:t.password,"onUpdate:modelValue":s[1]||(s[1]=a=>t.password=a)},{prefix:o(()=>[e(l,null,{default:o(()=>[e(f(F))]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(u,{prop:"checkpass"},{default:o(()=>[e(n,{placeholder:"请输入密码",type:"password","show-password":"",modelValue:t.checkpass,"onUpdate:modelValue":s[2]||(s[2]=a=>t.checkpass=a)},{prefix:o(()=>[e(l,null,{default:o(()=>[e(f(F))]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(u,null,{default:o(()=>[e(y,{type:"primary",style:{width:"100%"},onClick:s[3]||(s[3]=a=>h(p.value))},{default:o(()=>[g(" 登录 ")]),_:1})]),_:1}),e(u,null,{default:o(()=>[d("div",M,[g(" 还没有账号？请 "),e(P,{type:"warning",onClick:s[4]||(s[4]=a=>k(p.value))},{default:o(()=>[g(" 前往注册 ")]),_:1})])]),_:1})]),_:1},8,["rules","model"])}}},J=S(j,[["__scopeId","data-v-af9c3d0a"]]);const z={class:"registerTip"},W={__name:"registerForm",emits:["toLogin"],setup(c,{emit:_}){const t=V({userid:"",password:"",checkpass:""}),p=b(null),v=V({userid:[{required:!0,message:"请输入账号！",trigger:"blur"}],password:[{required:!0,message:"请确认密码！",trigger:"blur"}],checkpass:[{required:!0,message:"请输入密码",trigger:"blur"},{validator:(r,s,l)=>{s!==t.password?l(new Error("密码不一致！")):l()},trigger:"blur"}]}),h=async r=>{r&&await r.validate((s,l)=>{if(s)return m();for(const n in l)if(Object.hasOwnProperty.call(l,n)){w.error(l[n][0].message);return}})},m=async()=>{console.log(t);const r=await B({userid:t.userid,password:t.password});if(r.code!==200)return w.error(r.msg);w.success("注册成功"),_("toLogin"),t.userid="",t.password="",t.checkpass=""},k=r=>(_("toLogin"),r.resetFields());return(r,s)=>{const l=i("el-icon"),n=i("el-input"),u=i("el-form-item"),y=i("el-button"),P=i("el-link"),R=i("el-form");return q(),O(R,{ref_key:"registerFormRef",ref:p,rules:v,model:t,"label-width":"0px"},{default:o(()=>[e(u,{prop:"userid"},{default:o(()=>[e(n,{placeholder:"请输入账号",modelValue:t.userid,"onUpdate:modelValue":s[0]||(s[0]=a=>t.userid=a)},{prefix:o(()=>[e(l,null,{default:o(()=>[e(f(T))]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(u,{prop:"password"},{default:o(()=>[e(n,{placeholder:"请输入密码",type:"password","show-password":"",modelValue:t.password,"onUpdate:modelValue":s[1]||(s[1]=a=>t.password=a)},{prefix:o(()=>[e(l,null,{default:o(()=>[e(f(F))]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(u,{prop:"checkpass"},{default:o(()=>[e(n,{placeholder:"请输入密码",type:"password","show-password":"",modelValue:t.checkpass,"onUpdate:modelValue":s[2]||(s[2]=a=>t.checkpass=a)},{prefix:o(()=>[e(l,null,{default:o(()=>[e(f(F))]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(u,null,{default:o(()=>[e(y,{type:"primary",style:{width:"100%"},onClick:s[3]||(s[3]=a=>h(p.value))},{default:o(()=>[g(" 注册 ")]),_:1})]),_:1}),e(u,null,{default:o(()=>[d("div",z,[g(" 已有账号？请 "),e(P,{type:"warning",onClick:s[4]||(s[4]=a=>k(p.value))},{default:o(()=>[g(" 前往登录 ")]),_:1})])]),_:1})]),_:1},8,["rules","model"])}}},X=S(W,[["__scopeId","data-v-8b38ede1"]]);const C=c=>(A("data-v-f3e2ade6"),c=c(),H(),c),D={class:"login"},G=C(()=>d("div",{class:"login-mask"},null,-1)),K={class:"login-box"},Q=C(()=>d("div",{class:"login-box-left"},[d("div",{class:"login-box-left-logo"},[d("i",{class:"iconfont icon-circulation"})]),d("div",{class:"login-box-left-tip"},[d("ul",null,[d("li",null,"多人协作在线编辑器-Multi Person Online Editor"),d("li",null,"支持Word、Excel、TXT、Markdown等多文件类型"),d("li",null,"效率高、低成本、时效性、多版本控制")])])],-1)),Y={class:"login-box-form"},Z={__name:"index",setup(c){const _=b("login"),t=b("LoginAnimation"),p=b("登录"),I=()=>(t.value="RegisterAnimation",p.value="注册"),v=()=>(t.value="LoginAnimation",p.value="登录");return L(()=>sessionStorage.clear()),(h,m)=>{const k=i("el-tab-pane"),r=i("el-tabs");return q(),E("div",D,[G,d("div",K,[Q,d("div",Y,[e(r,{modelValue:_.value,"onUpdate:modelValue":m[0]||(m[0]=s=>_.value=s),class:"demo-tabs"},{default:o(()=>[e(k,{label:p.value,name:"login",class:U(t.value)},{default:o(()=>[e(J,{onToRegister:I}),e(X,{onToLogin:v})]),_:1},8,["label","class"])]),_:1},8,["modelValue"])])])])}}},oe=S(Z,[["__scopeId","data-v-f3e2ade6"]]);export{oe as default};
