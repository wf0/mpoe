import{_ as L,l as F,r as h,m as T,a as i,o as P,i as U,e as t,d as s,u as w,U as $,V as I,z as f,b as a,y as v,f as V,c as A,n as E,p as H,h as N}from"./index-d6e93156.js";import{f as O}from"./index-4be6247f.js";const B=p=>O({url:"/user/login",method:"post",data:p}),M=p=>O({url:"/user/register",method:"post",data:p});const z={class:"registerTip"},J={__name:"loginForm",emits:["toRegister"],setup(p,{emit:m}){const o=F({userid:"",password:"",checkpass:"",remember:!1}),d=h(null),b=F({userid:[{required:!0,message:"请输入账号！",trigger:"blur"}],password:[{required:!0,message:"请输入密码！",trigger:"blur"}],checkpass:[{required:!0,message:"请输入密码",trigger:"blur"},{validator:(l,e,r)=>{e!==o.password?r(new Error("密码不一致！")):r()},trigger:"blur"}]}),x=async l=>{l&&await l.validate((e,r)=>{if(e)return g();for(const n in r)if(Object.hasOwnProperty.call(r,n)){v.error(r[n][0].message);return}})},g=async()=>{let l=await B({userid:o.userid,password:o.password});if(l.code!==200)return v.error(l.msg);v.success(l.msg);let e=JSON.parse(JSON.stringify(l.data)),{token:r}=e;if(delete e.token,sessionStorage.setItem("token",r),sessionStorage.setItem("user",JSON.stringify(e)),o.remember,V.currentRoute.value.query.fileid){let{fileid:n,filename:u,username:y}=V.currentRoute.value.query;return V.push({path:`/invited/${n}`,query:{filename:u,username:y}})}V.push("/home")},k=l=>(m("toRegister"),l.resetFields());return T(()=>{sessionStorage.clear()}),(l,e)=>{const r=i("el-icon"),n=i("el-input"),u=i("el-form-item"),y=i("el-button"),S=i("el-checkbox"),q=i("el-link"),c=i("el-form");return P(),U(c,{ref_key:"loginFormRef",ref:d,rules:b,model:o,"label-width":"0px"},{default:t(()=>[s(u,{prop:"userid"},{default:t(()=>[s(n,{placeholder:"请输入账号",modelValue:o.userid,"onUpdate:modelValue":e[0]||(e[0]=_=>o.userid=_)},{prefix:t(()=>[s(r,null,{default:t(()=>[s(w($))]),_:1})]),_:1},8,["modelValue"])]),_:1}),s(u,{prop:"password"},{default:t(()=>[s(n,{placeholder:"请输入密码",type:"password","show-password":"",modelValue:o.password,"onUpdate:modelValue":e[1]||(e[1]=_=>o.password=_)},{prefix:t(()=>[s(r,null,{default:t(()=>[s(w(I))]),_:1})]),_:1},8,["modelValue"])]),_:1}),s(u,{prop:"checkpass"},{default:t(()=>[s(n,{placeholder:"请输入密码",type:"password","show-password":"",modelValue:o.checkpass,"onUpdate:modelValue":e[2]||(e[2]=_=>o.checkpass=_)},{prefix:t(()=>[s(r,null,{default:t(()=>[s(w(I))]),_:1})]),_:1},8,["modelValue"])]),_:1}),s(u,null,{default:t(()=>[s(y,{type:"primary",style:{width:"100%"},onClick:e[3]||(e[3]=_=>x(d.value))},{default:t(()=>[f(" 登录 ")]),_:1})]),_:1}),s(u,null,{default:t(()=>[a("div",z,[a("span",null,[s(S,{modelValue:o.remember,"onUpdate:modelValue":e[4]||(e[4]=_=>o.remember=_),size:"small"},null,8,["modelValue"]),f("记住账号")]),a("span",null,[f(" 还没有账号？请 "),s(q,{type:"warning",onClick:e[5]||(e[5]=_=>k(d.value))},{default:t(()=>[f(" 前往注册 ")]),_:1})])])]),_:1})]),_:1},8,["rules","model"])}}},j=L(J,[["__scopeId","data-v-9f3238a5"]]);const W={class:"registerTip"},X={__name:"registerForm",emits:["toLogin"],setup(p,{emit:m}){const o=F({userid:"",password:"",checkpass:""}),d=h(null),b=F({userid:[{required:!0,message:"请输入账号！",trigger:"blur"}],password:[{required:!0,message:"请确认密码！",trigger:"blur"}],checkpass:[{required:!0,message:"请输入密码",trigger:"blur"},{validator:(l,e,r)=>{e!==o.password?r(new Error("密码不一致！")):r()},trigger:"blur"}]}),x=async l=>{l&&await l.validate((e,r)=>{if(e)return g();for(const n in r)if(Object.hasOwnProperty.call(r,n)){v.error(r[n][0].message);return}})},g=async()=>{const l=await M({userid:o.userid,password:o.password});if(l.code!==200)return v.error(l.msg);v.success("注册成功"),m("toLogin"),o.userid="",o.password="",o.checkpass=""},k=l=>(m("toLogin"),l.resetFields());return(l,e)=>{const r=i("el-icon"),n=i("el-input"),u=i("el-form-item"),y=i("el-button"),S=i("el-link"),q=i("el-form");return P(),U(q,{ref_key:"registerFormRef",ref:d,rules:b,model:o,"label-width":"0px"},{default:t(()=>[s(u,{prop:"userid"},{default:t(()=>[s(n,{placeholder:"请输入账号",modelValue:o.userid,"onUpdate:modelValue":e[0]||(e[0]=c=>o.userid=c)},{prefix:t(()=>[s(r,null,{default:t(()=>[s(w($))]),_:1})]),_:1},8,["modelValue"])]),_:1}),s(u,{prop:"password"},{default:t(()=>[s(n,{placeholder:"请输入密码",type:"password","show-password":"",modelValue:o.password,"onUpdate:modelValue":e[1]||(e[1]=c=>o.password=c)},{prefix:t(()=>[s(r,null,{default:t(()=>[s(w(I))]),_:1})]),_:1},8,["modelValue"])]),_:1}),s(u,{prop:"checkpass"},{default:t(()=>[s(n,{placeholder:"请输入密码",type:"password","show-password":"",modelValue:o.checkpass,"onUpdate:modelValue":e[2]||(e[2]=c=>o.checkpass=c)},{prefix:t(()=>[s(r,null,{default:t(()=>[s(w(I))]),_:1})]),_:1},8,["modelValue"])]),_:1}),s(u,null,{default:t(()=>[s(y,{type:"primary",style:{width:"100%"},onClick:e[3]||(e[3]=c=>x(d.value))},{default:t(()=>[f(" 注册 ")]),_:1})]),_:1}),s(u,null,{default:t(()=>[a("div",W,[f(" 已有账号？请 "),s(S,{type:"warning",onClick:e[4]||(e[4]=c=>k(d.value))},{default:t(()=>[f(" 前往登录 ")]),_:1})])]),_:1})]),_:1},8,["rules","model"])}}},D=L(X,[["__scopeId","data-v-6de2e534"]]);const C=p=>(H("data-v-aa9b62fc"),p=p(),N(),p),G={class:"login"},K=C(()=>a("div",{class:"login-mask"},null,-1)),Q={class:"login-box"},Y=C(()=>a("div",{class:"login-box-left"},[a("div",{class:"login-box-left-logo"},[a("i",{class:"iconfont icon-circulation"})]),a("div",{class:"login-box-left-tip"},[a("ul",null,[a("li",null,"多人协作在线编辑器-Multi Person Online Editor"),a("li",null,"支持Word、Excel、TXT、Markdown等多文件类型"),a("li",null,"效率高、低成本、时效性、多版本控制")])])],-1)),Z={class:"login-box-form"},ee={__name:"index",setup(p){const m=h("login"),o=h("LoginAnimation"),d=h("登录"),R=()=>(o.value="RegisterAnimation",d.value="注册"),b=()=>(o.value="LoginAnimation",d.value="登录");return T(()=>sessionStorage.clear()),(x,g)=>{const k=i("el-tab-pane"),l=i("el-tabs");return P(),A("div",G,[K,a("div",Q,[Y,a("div",Z,[s(l,{modelValue:m.value,"onUpdate:modelValue":g[0]||(g[0]=e=>m.value=e),class:"demo-tabs"},{default:t(()=>[s(k,{label:d.value,name:"login",class:E(o.value)},{default:t(()=>[s(j,{onToRegister:R}),s(D,{onToLogin:b})]),_:1},8,["label","class"])]),_:1},8,["modelValue"])])])])}}},te=L(ee,[["__scopeId","data-v-aa9b62fc"]]);export{te as default};
